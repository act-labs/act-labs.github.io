(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{719:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(14),i=a.n(o),s=a(15),c=a.n(s),l=a(1),m=function(e){function t(t){var a;return(a=e.call(this,t)||this).layout=null,a}return c()(t,e),t.prototype.render=function(){var e=this.props,t=e.components;i()(e,["components"]);return r.a.createElement(l.MDXTag,{name:"wrapper",components:t},r.a.createElement(l.MDXTag,{name:"p",components:t},"Our sample Express and MySql application may potentially require schema updates. Schema updates could be tricky, especially when applied to big databases in production. To avoid problems in the future and simplify maintenance, project should adopt certain best practices."),r.a.createElement(l.MDXTag,{name:"h2",components:t},"Migration scripts"),r.a.createElement(l.MDXTag,{name:"p",components:t},"I put all DDL statements for a projects in a separate directory ",r.a.createElement(l.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"/src/sql/migrations")," in files following ",r.a.createElement(l.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"VXXXX_XXX__description.sql")," pattern. Such schema updates are usually applied by many database utilities in an alphabetical order. So newer updates should go in files with higher version numbers (a new file is strictly required as soon as a previous update was used in a production). In our simple example, the first database table creation command goes into file ",r.a.createElement(l.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"V0001_001__createContactUsTable.sql"),":"),r.a.createElement(l.MDXTag,{name:"pre",components:t},r.a.createElement(l.MDXTag,{name:"code",components:t,parentName:"pre",props:{className:"language-sql"}},"CREATE TABLE IF NOT EXISTS CONTACT_US (\n    id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,\n    created DATETIME DEFAULT CURRENT_TIMESTAMP,\n    first_name varchar(25),\n    last_name varchar(25),\n    phone varchar(25),\n    address varchar(255),\n    email varchar(50),\n    message text\n)\n")),r.a.createElement(l.MDXTag,{name:"h2",components:t},"MySql container for development and production"),r.a.createElement(l.MDXTag,{name:"p",components:t},"For development we may build a simple container with schema built in, which is luckily pretty simple:"),r.a.createElement(l.MDXTag,{name:"pre",components:t},r.a.createElement(l.MDXTag,{name:"code",components:t,parentName:"pre",props:{className:"language-dockerfile"}},"FROM mysql:5.7\n\nCOPY . /docker-entrypoint-initdb.d/\n")),r.a.createElement(l.MDXTag,{name:"p",components:t},"A new container is built from standard MySql Docker container, then all migration scripts are copied into ",r.a.createElement(l.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"/docker-entrypoint-initdb.d/")," directory, where they will be executed in alphabetical order on every container start up. To check - connect to  container and use standard command line utilities:"),r.a.createElement(l.MDXTag,{name:"pre",components:t},r.a.createElement(l.MDXTag,{name:"code",components:t,parentName:"pre",props:{className:"language-sh"}},"docker exec -it js-test-mysql bash\n$ mysql -uroot -p\nEnter password: (jstest)\nmysql> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| jstest             |\n| mysql              |\n| performance_schema |\n| sys                |\n+--------------------+\n5 rows in set (0.00 sec)\nmysql> use jstest;\nmysql> show tables;\n")),r.a.createElement(l.MDXTag,{name:"p",components:t},"While this method works for development, in production environment it is better to keep database tables in a mounted volume. To manage updates there, tools like Flyway, could be used, which can connect to the database, select smartly missing updates and apply them correctly."))},t}(r.a.Component),u=a(753);function p(e){return r.a.createElement(u.a,e,r.a.createElement(m,e))}a.d(t,"default",function(){return p})},732:function(e,t,a){"use strict";a(46);var n=a(733),r=a(0),o=a.n(r),i=a(2),s=a.n(i),c=a(744),l=a.n(c),m=a(34);function u(e){var t=e.description,a=e.lang,r=e.meta,i=e.keywords,s=e.title;return o.a.createElement(m.b,{query:p,render:function(e){return"string"==typeof i&&(i=i.split(",").map(function(e){return e.trim()})),t=t||e.site.siteMetadata.description,o.a.createElement(l.a,{htmlAttributes:{lang:a},title:s,titleTemplate:"%s | "+e.site.siteMetadata.project,meta:[{name:"description",content:t},{property:"og:title",content:s},{property:"og:description",content:t},{property:"og:type",content:"website"},{name:"twitter:card",content:"summary"},{name:"twitter:creator",content:e.site.siteMetadata.author},{name:"twitter:title",content:s},{name:"twitter:description",content:t}].concat(i?{name:"keywords",content:i.join(", ")}:[]).concat(r)})},data:n})}u.defaultProps={lang:"en",meta:[],keywords:null},u.propTypes={description:s.a.string,lang:s.a.string,meta:s.a.array,keywords:s.a.oneOfType([s.a.string,s.a.arrayOf(s.a.string)]),title:s.a.string.isRequired},t.a=u;var p="304502870"},733:function(e){e.exports={data:{site:{siteMetadata:{project:"ACT blog",description:"React, Ant Design, Gatsby, GraphQl, and other web technologies",author:"Act Labs"}}}}},734:function(e,t,a){"use strict";a.d(t,"a",function(){return l});a(352);var n=a(735),r=a(0),o=a.n(r),i=a(34),s=a(231),c=a.n(s);function l(){return o.a.createElement(i.b,{query:"2369744027",render:function(e){return o.a.createElement(c.a,{fixed:e.logo.childImageSharp.fixed,style:{float:"left"}})},data:n})}},735:function(e){e.exports={data:{logo:{childImageSharp:{fixed:{base64:"data:image/png;base64,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",width:50,height:60,src:"/static/a64620346ac3ce8d4580a3f07039fa3c/8469d/logo.png",srcSet:"/static/a64620346ac3ce8d4580a3f07039fa3c/8469d/logo.png 1x"}}}}}},736:function(e){e.exports={data:{config:{copyright:"Copyright Â© Act Labs",social:[{icon:"facebook",link:"https://www.facebook.com/ACT7LAB"},{icon:"github",link:"https://github.com/act-labs/gatsby-starter-act-blog"}]}}}},737:function(e){e.exports={data:{config:{nav:[{text:"home",slug:null},{text:"posts",slug:"/posts/"},{text:"snippets",slug:"/snippets/"}]}}}},738:function(e,t,a){"use strict";a(6);var n=a(138),r=(a(178),a(31)),o=a.n(r),i=(a(745),a(730),a(731)),s=a.n(i),c=a(736),l=a(0),m=a.n(l),u=a(34),p=s.a.Footer;function d(e){var t=e.social,a=e.copyright,r=t.map(function(e){var t=e.link,a=e.icon;return m.a.createElement(n.a,{key:a,to:t},m.a.createElement(o.a,{type:a,style:{fontSize:"24px",marginLeft:10,color:"rgba(0, 0, 0, 0.65)"}}))});return m.a.createElement(p,{style:{textAlign:"center"}},m.a.createElement("div",null,a,m.a.createElement("div",{style:{float:"right"}},r)))}function g(e){return e.social?m.a.createElement(d,e):m.a.createElement(u.b,{query:"2743462859",render:function(t){var a=t.config,n=a.social,r=a.copyright;return m.a.createElement(d,Object.assign({social:n,copyright:r},e))},data:c})}a(742);var h=a(741),y=a.n(h),f=a(734),E=a(737),b=s.a.Header;function v(e){var t=e.nav;return m.a.createElement(b,{className:"navigation-bar"},m.a.createElement(n.a,{to:"/"},m.a.createElement(f.a,null)),m.a.createElement(y.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:t.filter(function(e){return e.selected}).map(function(e){return e.text}),style:{lineHeight:"64px"}},t.map(function(e,t){var a=e.slug,r=e.text;return m.a.createElement(y.a.Item,{key:t},m.a.createElement(n.a,{to:a||"/"},r))})))}function A(e){return e.nav?m.a.createElement(v,e):m.a.createElement(u.b,{query:"1250442554",render:function(t){var a=t.config.nav;return m.a.createElement(v,Object.assign({nav:a},e))},data:E})}var M=a(732),w=a(14),T=a.n(w);a(671);a.d(t,"a",function(){return O});var k=s.a.Content,D=s.a.Sider;function X(e){var t=e.style,a=e.children,n=T()(e,["style","children"]);return m.a.createElement(k,Object.assign({style:Object.assign({padding:"5px 24px"},t)},n),a)}function O(e){var t=e.children,a=e.className,n=e.title,r=e.description,o=e.keywords,i=e.style,c=e.layout,l=Object.assign({},N,c),u=l.footer,p=l.fullHeight,d=Object.assign({},p?{height:"100%"}:null,i),h=(a?a+" ":"")+"page-layout";return m.a.createElement(s.a,{className:h,style:d},m.a.createElement(M.a,{title:n,keywords:o,description:r}),m.a.createElement(A,null),t,u?m.a.createElement(g,null):null)}var N={footer:!0};O.Panel=X,O.SideMenuPanel=function(e){var t=e.children,a=e.menu;return m.a.createElement(s.a,{style:{padding:"1em 0",background:"#fff",minHeight:1e3}},m.a.createElement(D,{width:200},a),m.a.createElement(X,null,t))}},740:function(e,t,a){"use strict";a(6);var n=a(138),r=(a(46),a(0)),o=a.n(r),i=a(884),s=a(746),c=a(747),l=a(748),m=a(749),u=a(750),p=a(751);i.a.registerLanguage("javascript",s.a),i.a.registerLanguage("sh",c.a),i.a.registerLanguage("markdown",l.a),i.a.registerLanguage("yaml",m.a),i.a.registerLanguage("dockerfile",u.a);var d=a(1);a.d(t,"a",function(){return h});var g={components:{code:function(e){var t="bash";if(e.className){var a=e.className.split("-");a.length>1&&(t=a[1])}return o.a.createElement(i.a,{language:t,style:p.github},e.children)},a:n.a}};function h(e){var t=Object.assign({},g,e),a=t.components,n=t.children;return o.a.createElement(d.MDXProvider,{components:a},n)}},753:function(e,t,a){"use strict";a.d(t,"a",function(){return c});var n=a(740),r=(a(6),a(738)),o=a(0),i=a.n(o),s=(a(672),r.a.Panel);function c(e){var t=e.children,a=e.pageContext,o=Object.assign({frontmatter:{}},a),c=Object.assign({},{layout:o.layout},o.frontmatter);return i.a.createElement(r.a,c,i.a.createElement(s,{style:{paddingTop:"1em"}},c.title?i.a.createElement("h1",null,c.title):null,i.a.createElement(n.a,null,t)))}}}]);
//# sourceMappingURL=component---src-generated-posts-shcema-migration-js-124e4191a42ad60c0567.js.map