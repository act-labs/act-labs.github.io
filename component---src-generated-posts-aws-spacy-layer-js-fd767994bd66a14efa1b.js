(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{713:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(142),s=a(14),i=a.n(s),c=a(15),l=a.n(c),m=a(1),p=function(e){function t(t){var a;return(a=e.call(this,t)||this).layout=null,a}return l()(t,e),t.prototype.render=function(){var e=this.props,t=e.components;i()(e,["components"]);return r.a.createElement(m.MDXTag,{name:"wrapper",components:t},r.a.createElement(m.MDXTag,{name:"p",components:t},r.a.createElement(m.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://spacy.io/",title:"natural language processing toolkit"}},"spaCy")," is a popular natural language processing toolkit. It can be used to tokenize text and get information about each word (part of speech, named entities, lemma, word vector, word dependencies, etc). This tool can be really handy, when doing any text analyses. Such processing could be done on AWS EC2 instances, but if you do your data analyses only sporadically, AWS lambda becomes a viable alternative. And luckily enough, thanks to ",r.a.createElement(m.MDXTag,{name:"em",components:t,parentName:"p"},"AWS layers"),", an AWS lambdas today may execute Python code importing pretty much any library. For example, in this post a simple AWS lambda function, configured using serverless framework, handles HTTP requests and returns lists of nouns, parsing text with the help of spaCy."),r.a.createElement(o.a,{more:"/snippets/serverless/serverless-cli/",title:"Create new serverless Python 3 project"},r.a.createElement(m.MDXTag,{name:"pre",components:t},r.a.createElement(m.MDXTag,{name:"code",components:t,parentName:"pre",props:{className:"language-sh"}},"serverless create --template  aws-python3 --path example\n"))),r.a.createElement(m.MDXTag,{name:"p",components:t},"Packaging AWS layers may require some work, but for popular frameworks like spaCy, publicly accessible AWS layers are available, so we may take the ",r.a.createElement(m.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://github.com/keithrozario/Klayers",title:"github repository with AWS layers for popular Python packages"}},"existing one"),", in which case we only need to add AWS ARN to the list of layers used:"),r.a.createElement(m.MDXTag,{name:"pre",components:t},r.a.createElement(m.MDXTag,{name:"code",components:t,parentName:"pre",props:{className:"language-yaml"}},"# from serverless.yaml\nfunctions:\n  nouns:\n    handler: handler.nouns\n    layers:\n      - arn:aws:lambda:${self:provider.region}:113088814899:layer:Klayers-python37-spacy:1\n")),r.a.createElement(m.MDXTag,{name:"p",components:t},"To minimize resources usage, this layer comes only with small English language model (which is more than enough for many everyday text processing tasks), loaded at lambda startup through ",r.a.createElement(m.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"nlp = spacy.load('/opt/en_core_web_sm-2.1.0')"),". To test spaCy, we may implement simple HTTP endpoint returning list of lemmatized nouns (which actually could be of practical interest, for example, in some simple keyword extraction application):"),r.a.createElement(m.MDXTag,{name:"pre",components:t},r.a.createElement(m.MDXTag,{name:"code",components:t,parentName:"pre",props:{className:"language-python"}},'# our handler.py file\nimport json\nimport spacy\n\nnlp = spacy.load(\'/opt/en_core_web_sm-2.1.0\')\n\ndef nouns(event, context):\n    text = event["body"]\n    doc = nlp(text)\n    nouns = [token.lemma_ for token in doc if  token.pos_ == \'NOUN\']\n\n    response = {\n        "statusCode": 200,\n        "body": json.dumps(nouns)\n    }\n\n    return response\n')),r.a.createElement(m.MDXTag,{name:"p",components:t},'Thus now we can send "black cat" to our ',r.a.createElement(m.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"/nouns")," endpoint to get ",'["cat"]'," back:"),r.a.createElement(m.MDXTag,{name:"pre",components:t},r.a.createElement(m.MDXTag,{name:"code",components:t,parentName:"pre",props:{className:"language-sh"}},'curl -XPOST https://XXXXX..execute-api.us-east-1.amazonaws.com/dev/nouns -d "black cat"\n["cat"]\n')),r.a.createElement(m.MDXTag,{name:"p",components:t},"And that is it for using ",r.a.createElement(m.MDXTag,{name:"em",components:t,parentName:"p"},"spaCy")," natural language processor ",r.a.createElement(m.MDXTag,{name:"em",components:t,parentName:"p"},"in AWS lambda"),". Now we can start building our own complex text processing pipelines! Use this example source code on ",r.a.createElement(m.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://github.com/act-labs/aws-spacy-layer-example",title:"Simple HTTP endpoint example using AWS spaCy layer and serverless framework"}},"Github")," as your starting point. "))},t}(r.a.Component),u=a(748);function g(e){return r.a.createElement(u.a,e,r.a.createElement(p,e))}a.d(t,"default",function(){return g})},727:function(e,t,a){"use strict";a(46);var n=a(728),r=a(0),o=a.n(r),s=a(2),i=a.n(s),c=a(739),l=a.n(c),m=a(34);function p(e){var t=e.description,a=e.lang,r=e.meta,s=e.keywords,i=e.title;return o.a.createElement(m.b,{query:u,render:function(e){return"string"==typeof s&&(s=s.split(",").map(function(e){return e.trim()})),t=t||e.site.siteMetadata.description,o.a.createElement(l.a,{htmlAttributes:{lang:a},title:i,titleTemplate:"%s | "+e.site.siteMetadata.project,meta:[{name:"description",content:t},{property:"og:title",content:i},{property:"og:description",content:t},{property:"og:type",content:"website"},{name:"twitter:card",content:"summary"},{name:"twitter:creator",content:e.site.siteMetadata.author},{name:"twitter:title",content:i},{name:"twitter:description",content:t}].concat(s?{name:"keywords",content:s.join(", ")}:[]).concat(r)})},data:n})}p.defaultProps={lang:"en",meta:[],keywords:null},p.propTypes={description:i.a.string,lang:i.a.string,meta:i.a.array,keywords:i.a.oneOfType([i.a.string,i.a.arrayOf(i.a.string)]),title:i.a.string.isRequired},t.a=p;var u="304502870"},728:function(e){e.exports={data:{site:{siteMetadata:{project:"ACT blog",description:"React, Ant Design, Gatsby, GraphQl, and other web technologies",author:"Act Labs"}}}}},729:function(e,t,a){"use strict";a.d(t,"a",function(){return l});a(352);var n=a(730),r=a(0),o=a.n(r),s=a(34),i=a(231),c=a.n(i);function l(){return o.a.createElement(s.b,{query:"2369744027",render:function(e){return o.a.createElement(c.a,{fixed:e.logo.childImageSharp.fixed,style:{float:"left"}})},data:n})}},730:function(e){e.exports={data:{logo:{childImageSharp:{fixed:{base64:"data:image/png;base64,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",width:50,height:60,src:"/static/a64620346ac3ce8d4580a3f07039fa3c/8469d/logo.png",srcSet:"/static/a64620346ac3ce8d4580a3f07039fa3c/8469d/logo.png 1x"}}}}}},731:function(e){e.exports={data:{config:{copyright:"Copyright Â© Act Labs",social:[{icon:"facebook",link:"https://www.facebook.com/ACT7LAB"},{icon:"github",link:"https://github.com/act-labs/gatsby-starter-act-blog"}]}}}},732:function(e){e.exports={data:{config:{nav:[{text:"home",slug:null},{text:"posts",slug:"/posts/"},{text:"snippets",slug:"/snippets/"}]}}}},733:function(e,t,a){"use strict";a(6);var n=a(138),r=(a(178),a(31)),o=a.n(r),s=(a(740),a(725),a(726)),i=a.n(s),c=a(731),l=a(0),m=a.n(l),p=a(34),u=i.a.Footer;function g(e){var t=e.social,a=e.copyright,r=t.map(function(e){var t=e.link,a=e.icon;return m.a.createElement(n.a,{key:a,to:t},m.a.createElement(o.a,{type:a,style:{fontSize:"24px",marginLeft:10,color:"rgba(0, 0, 0, 0.65)"}}))});return m.a.createElement(u,{style:{textAlign:"center"}},m.a.createElement("div",null,a,m.a.createElement("div",{style:{float:"right"}},r)))}function d(e){return e.social?m.a.createElement(g,e):m.a.createElement(p.b,{query:"2743462859",render:function(t){var a=t.config,n=a.social,r=a.copyright;return m.a.createElement(g,Object.assign({social:n,copyright:r},e))},data:c})}a(737);var y=a(736),h=a.n(y),f=a(729),b=a(732),E=i.a.Header;function v(e){var t=e.nav;return m.a.createElement(E,{className:"navigation-bar"},m.a.createElement(n.a,{to:"/"},m.a.createElement(f.a,null)),m.a.createElement(h.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:t.filter(function(e){return e.selected}).map(function(e){return e.text}),style:{lineHeight:"64px"}},t.map(function(e,t){var a=e.slug,r=e.text;return m.a.createElement(h.a.Item,{key:t},m.a.createElement(n.a,{to:a||"/"},r))})))}function w(e){return e.nav?m.a.createElement(v,e):m.a.createElement(p.b,{query:"1250442554",render:function(t){var a=t.config.nav;return m.a.createElement(v,Object.assign({nav:a},e))},data:b})}var A=a(727),k=a(14),M=a.n(k);a(671);a.d(t,"a",function(){return D});var T=i.a.Content,x=i.a.Sider;function X(e){var t=e.style,a=e.children,n=M()(e,["style","children"]);return m.a.createElement(T,Object.assign({style:Object.assign({padding:"5px 24px"},t)},n),a)}function D(e){var t=e.children,a=e.className,n=e.title,r=e.description,o=e.keywords,s=e.style,c=e.layout,l=Object.assign({},N,c),p=l.footer,u=l.fullHeight,g=Object.assign({},u?{height:"100%"}:null,s),y=(a?a+" ":"")+"page-layout";return m.a.createElement(i.a,{className:y,style:g},m.a.createElement(A.a,{title:n,keywords:o,description:r}),m.a.createElement(w,null),t,p?m.a.createElement(d,null):null)}var N={footer:!0};D.Panel=X,D.SideMenuPanel=function(e){var t=e.children,a=e.menu;return m.a.createElement(i.a,{style:{padding:"1em 0",background:"#fff",minHeight:1e3}},m.a.createElement(x,{width:200},a),m.a.createElement(X,null,t))}},735:function(e,t,a){"use strict";a(6);var n=a(138),r=(a(46),a(0)),o=a.n(r),s=a(878),i=a(742),c=a(743),l=a(744),m=a(745),p=a(746),u=a(747);s.a.registerLanguage("javascript",i.a),s.a.registerLanguage("sh",c.a),s.a.registerLanguage("markdown",l.a),s.a.registerLanguage("yaml",m.a),s.a.registerLanguage("dockerfile",p.a);var g=a(1);a.d(t,"a",function(){return y});var d={components:{code:function(e){var t="bash";if(e.className){var a=e.className.split("-");a.length>1&&(t=a[1])}return o.a.createElement(s.a,{language:t,style:u.github},e.children)},a:n.a}};function y(e){var t=Object.assign({},d,e),a=t.components,n=t.children;return o.a.createElement(g.MDXProvider,{components:a},n)}},748:function(e,t,a){"use strict";a.d(t,"a",function(){return c});var n=a(735),r=(a(6),a(733)),o=a(0),s=a.n(o),i=(a(672),r.a.Panel);function c(e){var t=e.children,a=e.pageContext,o=Object.assign({frontmatter:{}},a),c=Object.assign({},{layout:o.layout},o.frontmatter);return s.a.createElement(r.a,c,s.a.createElement(i,{style:{paddingTop:"1em"}},c.title?s.a.createElement("h1",null,c.title):null,s.a.createElement(n.a,null,t)))}}}]);
//# sourceMappingURL=component---src-generated-posts-aws-spacy-layer-js-fd767994bd66a14efa1b.js.map