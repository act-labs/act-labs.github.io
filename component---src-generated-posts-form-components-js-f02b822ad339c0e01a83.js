(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{723:function(e,n,t){"use strict";t.r(n);var a=t(0),o=t.n(a),r=t(14),i=t.n(r),l=t(15),c=t.n(l),s=t(1),m=function(e){function n(n){var t;return(t=e.call(this,n)||this).layout=null,t}return c()(n,e),n.prototype.render=function(){var e=this.props,n=e.components;i()(e,["components"]);return o.a.createElement(s.MDXTag,{name:"wrapper",components:n},o.a.createElement(s.MDXTag,{name:"p",components:n},"Lets create a simple form, exploring function children and component cloning techniques along the way. Currently there are many libraries providing good form components, but creating such components from scratch could be a fun learning exercise which will provide as a good playground to play with different techniques. Also my other, sample ",o.a.createElement(s.MDXTag,{name:"a",components:n,parentName:"p",props:{href:"/posts/contact-us-form/",title:"Jest, developing and testing UI for Contact Us form"}},"Contact Us form")," project needed some form components, so I really had no choice. Source code discussed, along with ",o.a.createElement(s.MDXTag,{name:"a",components:n,parentName:"p",props:{href:"/posts/mysql-express/",title:"Express and MySql. Simple Contact Us form"}},"Express/MySql server"),", could be found on ",o.a.createElement(s.MDXTag,{name:"a",components:n,parentName:"p",props:{href:"https://github.com/act-labs/contact-us",title:"Sample contact-us app using React/MySql/Express"}},"Github"),"."),o.a.createElement(s.MDXTag,{name:"h2",components:n},"Form components"),o.a.createElement(s.MDXTag,{name:"p",components:n},"Form components pose an interesting challenge, as multiple input components not only should be functional on their own, but should also interact with each other to support validation/network requests. To orchestrate such communication, we could create some React context, but this would be undesirable as one may wish to keep validation and presentation logic separate from each other. Luckily there are two alternative techniques, which could be helpful and which will be investigated here: functions as component children and component cloning."),o.a.createElement(s.MDXTag,{name:"p",components:n},"Lets start from children as functions. To decouple presentation and validation, I created two components: ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"Form")," and ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"Field"),". Their job will be validation logic. ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"Field")," also will be responsible to layout form and will control child components:"),o.a.createElement(s.MDXTag,{name:"pre",components:n},o.a.createElement(s.MDXTag,{name:"code",components:n,parentName:"pre",props:{className:"language-javascript"}},'const App = () => {\n  ...............................\n\n  return (\n    <div className="App">\n      <header className="App-header">\n        <h1>Contact Us</h1>\n        <p>{last}</p>\n\n        <Form onSubmit={onSubmit}>\n          <Field label={"First name"} name="first_name" required>{({ fieldProps }) => <TextField {...fieldProps} />}</Field>\n          <Field label={"Last name"} name="last_name">{({ fieldProps }) => <TextField {...fieldProps} />}</Field>\n          <Field label={"Address"} name="address" >{({ fieldProps }) => <TextField {...fieldProps} />}</Field>\n          <Field label={"Phone"} name="phone">{({ fieldProps }) => <TextField {...fieldProps} />}</Field>\n          <Field label={"Email"} name="email" required email>{({ fieldProps }) => <TextField {...fieldProps} />}</Field>\n          <Field label={"Message"} name="message" required>{({ fieldProps }) => <Textarea {...fieldProps} />}</Field>\n          <input type="submit" value="Submit" />\n        </Form>\n      </header>\n    </div>\n  )\n}\n')),o.a.createElement(s.MDXTag,{name:"p",components:n},"As you can see, ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"<Field/>")," component receives common field properties like ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"label")," and ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"name")," and passes them, possibly with some modifications, to children using ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"fieldProps")," field of a child function argument. Thanks to children functions, the main goal is reached: ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"<Textarea/>")," and ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"<TextField/>")," could be completely unaware of the validation."),o.a.createElement(s.MDXTag,{name:"p",components:n},"As a side note, here we could use children cloning, which I will consider later. This is a valid alternative, but children functions give us additional flexibility, for example, if necessary, we can now change input components based on validation error (passed to children functions as another argument property)."),o.a.createElement(s.MDXTag,{name:"p",components:n},"Now, ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"Form")," and ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"Field")," components should be aware of each other, so we could use React context and children functions for even greater flexibility. But here I consider yet another, alternative technique instead: React cloning. The technique is quite old, and may seem a little bit hackish, but it could be a good alternative when components should interact with each other, still avoiding tight coupling:"),o.a.createElement(s.MDXTag,{name:"pre",components:n},o.a.createElement(s.MDXTag,{name:"code",components:n,parentName:"pre",props:{className:"language-javascript"}},'export const Form = ({ onSubmit, children }) => {\n  const validation = useRef({})\n  const values = useRef({})\n  const [errors, setErrors] = useState({})\n\n  const setValidation = (name, validator) => {\n    validation.current = { ...validation.current, [name]: validator }\n  }\n\n  const setValue = (name, value) => {\n    values.current = { ...values.current, [name]: value }\n  }\n\n  const handleSubmit = event => {\n    event.preventDefault()\n\n    const errors = Object.entries(validation.current).reduce((errors, [name, validator]) => {\n      const schema = joi.object({ [name]: validator })\n      const { error } = schema.validate({ [name]: values.current[name] })\n      if (error) {\n        errors[name] = error.message\n      }\n      return errors\n    }, {})\n\n    setErrors(errors)\n\n    if (Object.keys(errors).length) {\n      return\n    }\n\n    const schema = joi.object(validation.current)\n    const {value} = schema.validate(values.current)\n    if(onSubmit) {\n      onSubmit(value)\n    }\n  }\n\n  const augmented = React.Children.map(children, child => {\n    if (child.type === Field) {\n      return React.cloneElement(child, { setValidation, setValue, errors })\n    }\n    return child\n  })\n\n\n  return (\n    <div className="Form">\n      <form onSubmit={handleSubmit}>\n        {augmented}\n      </form>\n    </div>\n  )\n}\n')),o.a.createElement(s.MDXTag,{name:"p",components:n},"Here we call ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"React.cloneElement(child, { setValidation, setValue, errors })")," to add ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"setValidation"),", ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"setValue"),", and ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"errors")," properties to all ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"Field")," components. Here ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"setValidation")," is used to setup validation for each field, and ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"setValue")," - to update value on input element change event."),o.a.createElement(s.MDXTag,{name:"p",components:n},"Pretty evidently, component cloning plays nicely with children function technique and could be extended to do deep recursive cloning."),o.a.createElement(s.MDXTag,{name:"h2",components:n},"Next"),o.a.createElement(s.MDXTag,{name:"p",components:n},"Speaking about interaction between components, it is impossible not to mention ",o.a.createElement(s.MDXTag,{name:"em",components:n,parentName:"p"},"Redux"),". Tried and tested instrument, ",o.a.createElement(s.MDXTag,{name:"em",components:n,parentName:"p"},"Redux"),", especially in combination with ",o.a.createElement(s.MDXTag,{name:"em",components:n,parentName:"p"},"Redux Sagas"),", provides a clear, no-brainer tool to wire up applications of any complexity. As good and popular it is, nonetheless, it could be an overkill for simple components/applications."),o.a.createElement(s.MDXTag,{name:"p",components:n},"Now, when form components are created, it could be instructive to look at how they could be used and tested in simple ",o.a.createElement(s.MDXTag,{name:"a",components:n,parentName:"p",props:{href:"/posts/contact-us-form/",title:"Jest, developing and testing UI for Contact Us form"}},"Contact Us form")," app."))},n}(o.a.Component),p=t(753);function d(e){return o.a.createElement(p.a,e,o.a.createElement(m,e))}t.d(n,"default",function(){return d})},732:function(e,n,t){"use strict";t(46);var a=t(733),o=t(0),r=t.n(o),i=t(2),l=t.n(i),c=t(744),s=t.n(c),m=t(34);function p(e){var n=e.description,t=e.lang,o=e.meta,i=e.keywords,l=e.title;return r.a.createElement(m.b,{query:d,render:function(e){return"string"==typeof i&&(i=i.split(",").map(function(e){return e.trim()})),n=n||e.site.siteMetadata.description,r.a.createElement(s.a,{htmlAttributes:{lang:t},title:l,titleTemplate:"%s | "+e.site.siteMetadata.project,meta:[{name:"description",content:n},{property:"og:title",content:l},{property:"og:description",content:n},{property:"og:type",content:"website"},{name:"twitter:card",content:"summary"},{name:"twitter:creator",content:e.site.siteMetadata.author},{name:"twitter:title",content:l},{name:"twitter:description",content:n}].concat(i?{name:"keywords",content:i.join(", ")}:[]).concat(o)})},data:a})}p.defaultProps={lang:"en",meta:[],keywords:null},p.propTypes={description:l.a.string,lang:l.a.string,meta:l.a.array,keywords:l.a.oneOfType([l.a.string,l.a.arrayOf(l.a.string)]),title:l.a.string.isRequired},n.a=p;var d="304502870"},733:function(e){e.exports={data:{site:{siteMetadata:{project:"ACT blog",description:"React, Ant Design, Gatsby, GraphQl, and other web technologies",author:"Act Labs"}}}}},734:function(e,n,t){"use strict";t.d(n,"a",function(){return s});t(352);var a=t(735),o=t(0),r=t.n(o),i=t(34),l=t(231),c=t.n(l);function s(){return r.a.createElement(i.b,{query:"2369744027",render:function(e){return r.a.createElement(c.a,{fixed:e.logo.childImageSharp.fixed,style:{float:"left"}})},data:a})}},735:function(e){e.exports={data:{logo:{childImageSharp:{fixed:{base64:"data:image/png;base64,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",width:50,height:60,src:"/static/a64620346ac3ce8d4580a3f07039fa3c/8469d/logo.png",srcSet:"/static/a64620346ac3ce8d4580a3f07039fa3c/8469d/logo.png 1x"}}}}}},736:function(e){e.exports={data:{config:{copyright:"Copyright Â© Act Labs",social:[{icon:"facebook",link:"https://www.facebook.com/ACT7LAB"},{icon:"github",link:"https://github.com/act-labs/gatsby-starter-act-blog"}]}}}},737:function(e){e.exports={data:{config:{nav:[{text:"home",slug:null},{text:"posts",slug:"/posts/"},{text:"snippets",slug:"/snippets/"}]}}}},738:function(e,n,t){"use strict";t(6);var a=t(138),o=(t(178),t(31)),r=t.n(o),i=(t(745),t(730),t(731)),l=t.n(i),c=t(736),s=t(0),m=t.n(s),p=t(34),d=l.a.Footer;function u(e){var n=e.social,t=e.copyright,o=n.map(function(e){var n=e.link,t=e.icon;return m.a.createElement(a.a,{key:t,to:n},m.a.createElement(r.a,{type:t,style:{fontSize:"24px",marginLeft:10,color:"rgba(0, 0, 0, 0.65)"}}))});return m.a.createElement(d,{style:{textAlign:"center"}},m.a.createElement("div",null,t,m.a.createElement("div",{style:{float:"right"}},o)))}function g(e){return e.social?m.a.createElement(u,e):m.a.createElement(p.b,{query:"2743462859",render:function(n){var t=n.config,a=t.social,o=t.copyright;return m.a.createElement(u,Object.assign({social:a,copyright:o},e))},data:c})}t(742);var h=t(741),f=t.n(h),v=t(734),b=t(737),y=l.a.Header;function E(e){var n=e.nav;return m.a.createElement(y,{className:"navigation-bar"},m.a.createElement(a.a,{to:"/"},m.a.createElement(v.a,null)),m.a.createElement(f.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:n.filter(function(e){return e.selected}).map(function(e){return e.text}),style:{lineHeight:"64px"}},n.map(function(e,n){var t=e.slug,o=e.text;return m.a.createElement(f.a.Item,{key:n},m.a.createElement(a.a,{to:t||"/"},o))})))}function w(e){return e.nav?m.a.createElement(E,e):m.a.createElement(p.b,{query:"1250442554",render:function(n){var t=n.config.nav;return m.a.createElement(E,Object.assign({nav:t},e))},data:b})}var M=t(732),T=t(14),D=t.n(T);t(671);t.d(n,"a",function(){return N});var A=l.a.Content,X=l.a.Sider;function x(e){var n=e.style,t=e.children,a=D()(e,["style","children"]);return m.a.createElement(A,Object.assign({style:Object.assign({padding:"5px 24px"},n)},a),t)}function N(e){var n=e.children,t=e.className,a=e.title,o=e.description,r=e.keywords,i=e.style,c=e.layout,s=Object.assign({},F,c),p=s.footer,d=s.fullHeight,u=Object.assign({},d?{height:"100%"}:null,i),h=(t?t+" ":"")+"page-layout";return m.a.createElement(l.a,{className:h,style:u},m.a.createElement(M.a,{title:a,keywords:r,description:o}),m.a.createElement(w,null),n,p?m.a.createElement(g,null):null)}var F={footer:!0};N.Panel=x,N.SideMenuPanel=function(e){var n=e.children,t=e.menu;return m.a.createElement(l.a,{style:{padding:"1em 0",background:"#fff",minHeight:1e3}},m.a.createElement(X,{width:200},t),m.a.createElement(x,null,n))}},740:function(e,n,t){"use strict";t(6);var a=t(138),o=(t(46),t(0)),r=t.n(o),i=t(884),l=t(746),c=t(747),s=t(748),m=t(749),p=t(750),d=t(751);i.a.registerLanguage("javascript",l.a),i.a.registerLanguage("sh",c.a),i.a.registerLanguage("markdown",s.a),i.a.registerLanguage("yaml",m.a),i.a.registerLanguage("dockerfile",p.a);var u=t(1);t.d(n,"a",function(){return h});var g={components:{code:function(e){var n="bash";if(e.className){var t=e.className.split("-");t.length>1&&(n=t[1])}return r.a.createElement(i.a,{language:n,style:d.github},e.children)},a:a.a}};function h(e){var n=Object.assign({},g,e),t=n.components,a=n.children;return r.a.createElement(u.MDXProvider,{components:t},a)}},753:function(e,n,t){"use strict";t.d(n,"a",function(){return c});var a=t(740),o=(t(6),t(738)),r=t(0),i=t.n(r),l=(t(672),o.a.Panel);function c(e){var n=e.children,t=e.pageContext,r=Object.assign({frontmatter:{}},t),c=Object.assign({},{layout:r.layout},r.frontmatter);return i.a.createElement(o.a,c,i.a.createElement(l,{style:{paddingTop:"1em"}},c.title?i.a.createElement("h1",null,c.title):null,i.a.createElement(a.a,null,n)))}}}]);
//# sourceMappingURL=component---src-generated-posts-form-components-js-f02b822ad339c0e01a83.js.map